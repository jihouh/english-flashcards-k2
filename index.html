<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Small Steps Spelling</title>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&family=Klee+One:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --primary: #FF6B6B; --secondary: #4ECDC4; --accent: #FFE66D;
            --blue: #45aaf2; --bg: #F7FFF7; --gray: #555;
            --light-gray: #e0e0e0; --delete: #ff9f43;
            --purple: #a55eea; --shadow: #d4e5d4;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background-color: var(--bg);
            margin: 0; padding: 0;
            display: flex; flex-direction: column;
            height: 100vh; overflow: hidden;
            -webkit-user-select: none; user-select: none;
        }

        .header { width: 100%; display: flex; justify-content: space-between; align-items: center; padding: 15px; background: var(--bg); }
        h1 { font-size: 22px; color: var(--primary); margin: 0; font-family: 'Klee One', cursive; font-weight: 600; }
        .fullscreen-btn { background: #eee; color: #666; font-size: 13px; padding: 8px 12px; border-radius: 10px; border: 1px solid #ddd; cursor: pointer; font-weight: bold; }

        .nav-bar {
            position: fixed; bottom: 0; width: 100%; background: white; 
            display: flex; justify-content: space-around; padding: 15px 0;
            box-shadow: 0 -4px 15px rgba(0,0,0,0.1); z-index: 100;
        }
        .nav-item { font-family: 'Klee One', cursive; font-weight: bold; color: #888; cursor: pointer; font-size: 16px; text-align: center; flex: 1; }
        .nav-item i { display: block; font-size: 26px; margin-bottom: 4px; font-style: normal; }
        .nav-item.active { color: var(--primary); }

        .instruction-text { font-family: 'Klee One', cursive; color: var(--gray); font-size: 22px; margin-bottom: 10px; text-align: center; padding: 0 10px; font-weight: 600; }

        .container { flex: 1; display: flex; flex-direction: column; align-items: center; padding: 10px 20px 120px 20px; overflow-y: auto; }
        .screen { display: none; width: 100%; max-width: 500px; animation: fadeIn 0.3s; }
        .active-screen { display: flex; flex-direction: column; align-items: center; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .quote-card {
            background: white; width: 100%; padding: 20px; border-radius: 20px;
            border: 2px solid var(--shadow); box-shadow: 0 4px 10px var(--shadow);
            margin: 15px 0; text-align: center; cursor: pointer;
        }
        .quote-text { font-family: 'Klee One', cursive; color: var(--purple); font-size: 20px; font-weight: bold; line-height: 1.4; }

        button.action-btn { 
            padding: 15px 10px; border-radius: 20px; border: none; color: white; 
            font-weight: 900; cursor: pointer; font-family: 'Klee One', cursive; 
            box-shadow: 0 5px 0 rgba(0,0,0,0.1); font-size: 20px; text-transform: uppercase;
        }

        .card-img { max-width: 90%; max-height: 25vh; border-radius: 25px; background: white; padding: 15px; border: 5px solid var(--secondary); box-shadow: 0 8px 0px var(--shadow); }
        .big-word { font-size: clamp(3rem, 10vw, 5rem); color: var(--primary); margin: 20px 0; font-family: 'Comic Neue', cursive; font-weight: bold; cursor: pointer; }

        .match-btn {
            width: 100%; background: #ffffff; color: #222; 
            font-size: 34px; font-weight: 800; padding: 25px; 
            border-radius: 25px; border: 4px solid var(--accent);
            box-shadow: 0 8px 0px var(--accent); margin-bottom: 20px;
            font-family: 'Comic Neue', cursive; cursor: pointer;
        }

        .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; width: 100%; }
        .lib-card { background: white; color: black; border: 3px solid var(--light-gray); height: 110px; display: flex; align-items: center; justify-content: center; font-size: 32px; font-family: 'Comic Neue', cursive; font-weight: bold; border-radius: 20px; box-shadow: 0 5px 0 #ddd; cursor: pointer; }
        
        .sticker-slot { position: relative; background: white; border: 3px dashed #ccc; border-radius: 20px; padding: 12px; text-align: center; min-height: 140px; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .sticker-slot.unlocked { border: 3px solid var(--accent); background: #fffdf5; }
        .sticker-img { width: 80px; height: 80px; object-fit: contain; }
        .star-badge { position: absolute; top: -8px; right: -8px; background: var(--primary); color: white; border-radius: 50%; width: 35px; height: 35px; display: flex; align-items: center; justify-content: center; font-weight: bold; border: 2px solid white; font-size: 14px; box-shadow: 0 3px 6px rgba(0,0,0,0.2); }

        .slot { width: 50px; height: 60px; border-bottom: 5px solid var(--secondary); display: inline-block; margin: 0 6px; font-size: 2.5rem; color: var(--primary); text-align: center; font-family: 'Comic Neue'; font-weight: bold; }
        .letter-btn { width: 75px; height: 75px; background: var(--blue); border: none; border-radius: 18px; box-shadow: 0 5px 0px #348ecc; font-size: 2.2rem; font-family: 'Comic Neue', cursive; cursor: pointer; font-weight: bold; color: white; }

        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 1000; justify-content: center; align-items: center; }
        .popup-card { background: white; padding: 35px; border-radius: 35px; width: 340px; text-align: center; position: relative; }
        .close-btn { position: absolute; top: 15px; right: 15px; background: #eee; border: none; font-size: 24px; border-radius: 50%; width: 45px; height: 45px; cursor: pointer; }
    </style>
</head>
<body>

    <div class="header">
        <h1>Small Steps Spelling ‚ú®</h1>
        <button class="fullscreen-btn" onclick="toggleFullscreen()">üñ•Ô∏è FULLSCREEN</button>
    </div>

    <div id="lib-popup" class="overlay">
        <div class="popup-card">
            <button class="close-btn" onclick="closePopup()">‚úñ</button>
            <img id="pop-img" src="" class="card-img" style="max-height: 180px;">
            <div id="pop-word" class="big-word">word</div>
            <button class="action-btn" style="background: var(--secondary); width: 100%;" onclick="replayPopSequence()">üîä SPELL AGAIN</button>
        </div>
    </div>

    <div class="container">
        <div id="home" class="screen active-screen">
            <h2 style="font-family: 'Klee One', cursive; color: var(--primary); font-size: 32px; margin: 0;">Hi Student! üëã</h2>
            <div id="stars-total" class="instruction-text" style="color: var(--purple); font-weight: bold; font-size: 26px; margin-top: 5px;">üåü 0 Mastery Stars</div>
            
            <div class="instruction-text" style="font-size: 18px; margin-top: 15px; color: #888;">Tap the quote to hear it!</div>
            <div class="quote-card" onclick="readQuoteOutLoud()">
                <div id="motivational-quote" class="quote-text">Believe in yourself, you can do it!</div>
            </div>

            <div style="display: flex; flex-direction: column; gap: 15px; width: 100%;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <button class="action-btn" style="background: var(--secondary); height: 100px;" onclick="showScreen('learn')">üìñ LEARN</button>
                    <button class="action-btn" style="background: var(--blue); height: 100px;" onclick="showScreen('spell')">‚úèÔ∏è SPELL</button>
                    <button class="action-btn" style="background: var(--purple); height: 100px;" onclick="showScreen('match')">üß© MATCH</button>
                    <button class="action-btn" style="background: var(--primary); height: 100px;" onclick="showScreen('library')">üìö LIBRARY</button>
                </div>
                <button class="action-btn" style="background: #f1c40f; height: 100px; box-shadow: 0 5px 0 #d4ac0d;" onclick="showScreen('book')">üèÜ STICKER BOOK</button>
            </div>
        </div>

        <div id="learn" class="screen">
            <div class="instruction-text">Tap the word to hear it spelled!</div>
            <img id="learn-img" class="card-img" src="">
            <div id="learn-word" class="big-word" onclick="handleLearnClick()">word</div>
            <div style="display:flex; gap:15px; margin-top: 25px; width: 100%;">
                <button class="action-btn" style="background:var(--accent); color:black; flex:1" onclick="prevItem('learn')">‚¨ÖÔ∏è PREV</button>
                <button class="action-btn" style="background:var(--secondary); flex:1" onclick="nextItem('learn')">NEXT ‚û°Ô∏è</button>
            </div>
        </div>

        <div id="match" class="screen">
            <div class="instruction-text">Which word matches the picture?</div>
            <img id="match-img" class="card-img" src="">
            <div id="match-options" style="width:100%; margin-top:30px;"></div>
            <button class="action-btn" style="background:var(--accent); color:black; margin-top:15px; width:100%" onclick="prevItem('match')">‚¨ÖÔ∏è GO BACK</button>
        </div>

        <div id="spell" class="screen">
            <div class="instruction-text">Tap letters to spell the word!</div>
            <img id="spell-img" class="card-img" src="">
            <div id="spell-slots" style="margin: 25px 0;"></div>
            <div id="letter-pool" style="display:flex; flex-wrap:wrap; justify-content:center; gap:15px;"></div>
            <div style="display:flex; gap:15px; margin-top: 30px; width: 100%;">
                <button class="action-btn" style="background:var(--accent); color:black; flex:1" onclick="prevItem('spell')">‚¨ÖÔ∏è PREV</button>
                <button class="action-btn" style="background:var(--delete); flex:1" onclick="handleBackspace()">‚å´ DELETE</button>
            </div>
        </div>

        <div id="library" class="screen">
            <div class="instruction-text">Hold a word to see its picture!</div>
            <div class="grid" id="library-grid"></div>
        </div>

        <div id="book" class="screen">
            <div class="instruction-text">Stars show how many times you mastered it!</div>
            <div class="grid" id="book-grid"></div>
        </div>
    </div>

    <div class="nav-bar">
        <div class="nav-item active" id="nav-home" onclick="showScreen('home')"><i>üè†</i>Home</div>
        <div class="nav-item" id="nav-learn" onclick="showScreen('learn')"><i>üìñ</i>Learn</div>
        <div class="nav-item" id="nav-spell" onclick="showScreen('spell')"><i>‚úèÔ∏è</i>Spell</div>
        <div class="nav-item" id="nav-match" onclick="showScreen('match')"><i>üß©</i>Match</div>
        <div class="nav-item" id="nav-lib" onclick="showScreen('library')"><i>üìö</i>Lib</div>
        <div class="nav-item" id="nav-book" onclick="showScreen('book')"><i>üèÜ</i>Book</div>
    </div>

<script>
    // 1. AT LEAST 10 QUOTES
    const quotes = [
        "Believe in yourself, you can do it!",
        "Every small step counts toward success!",
        "Mistakes help us learn and grow bigger!",
        "You are doing a fantastic job today!",
        "Keep trying, you are a spelling superstar!",
        "You are smarter than you think!",
        "Success is a series of small steps!",
        "You make learning look easy and fun!",
        "Your brain is getting stronger every minute!",
        "Be brave, be curious, and keep going!",
        "You have the power to do great things!",
        "Today is a wonderful day to learn something new!"
    ];

    let wordList = [
      { word: 'food', img: 'https://img.freepik.com/premium-photo/authentic-chinese-food-photo-spring-rolls-noodles-dumplings-rice_1088041-52973.jpg?w=400', count: 0 },
      { word: 'rice', img: 'https://img.freepik.com/premium-vector/bowl-full-rice-vector-illustration_621660-2012.jpg?w=400', count: 0 },
      { word: 'soup', img: 'https://img.freepik.com/premium-vector/pumpkin-soup-bowl-isolated-white-background-traditional-autumn-thanksgiving-food-vector-illustration_693602-124.jpg', count: 0 },
      { word: 'porridge', img: 'https://img.freepik.com/premium-photo/traditional-chinese-porridge-rice-gruel-bowl_45583-882.jpg', count: 0 },
      { word: 'noodle', img: 'https://img.freepik.com/premium-vector/hakka-noodles-vector-illustration_621660-3511.jpg?w=400', count: 0 },
      { word: 'jelly', img: 'https://img.freepik.com/premium-vector/cartoon-sweet-dessert-pink-jelly-plate-vector-illustration_87850-525.jpg?w=400', count: 0 },
      { word: 'ice cream', img: 'https://img.freepik.com/free-vector/delicious-ice-cream-cones_1308-174629.jpg?w=400', count: 0 }
    ];

    // RANDOMISE WORD SEQUENCE ON START
    wordList.sort(() => 0.5 - Math.random());

    let learnIdx = 0, matchIdx = 0, spellIdx = 0, spellInput = "", pressTimer;
    let totalStars = parseInt(localStorage.getItem('engTotalStars')) || 0;

    function setRandomQuote() {
        document.getElementById('motivational-quote').innerText = quotes[Math.floor(Math.random() * quotes.length)];
    }

    function readQuoteOutLoud() {
        const t = document.getElementById('motivational-quote').innerText;
        window.speechSynthesis.cancel();
        const u = new SpeechSynthesisUtterance(t);
        u.lang = 'en-US';
        u.rate = 0.8; // SLOW DOWN QUOTE SPEED
        window.speechSynthesis.speak(u);
    }

    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.getElementById(id).classList.add('active-screen');
        const navId = (id === 'library' ? 'nav-lib' : 'nav-' + id);
        if(document.getElementById(navId)) document.getElementById(navId).classList.add('active');
        
        window.speechSynthesis.cancel();
        if(id === 'home') setRandomQuote();
        if(id === 'learn') renderLearn();
        if(id === 'match') renderMatch();
        if(id === 'spell') renderSpell();
        if(id === 'library') renderLibrary();
        if(id === 'book') renderStickers();
        document.getElementById('stars-total').innerText = `üåü ${totalStars} Mastery Stars`;
    }

    function earnWordSuccess(word) {
        const item = wordList.find(w => w.word === word);
        item.count++;
        totalStars++;
        localStorage.setItem('engTotalStars', totalStars);
        confetti({ particleCount: 150, spread: 80, origin: { y: 0.6 } });
        speak(word);
    }

    function renderLearn() {
        const item = wordList[learnIdx];
        document.getElementById('learn-img').src = item.img;
        document.getElementById('learn-word').innerText = item.word;
    }
    async function handleLearnClick() { await spellSequence(wordList[learnIdx].word); }

    async function spellSequence(word) {
        window.speechSynthesis.cancel();
        speak(word);
        await new Promise(r => setTimeout(r, 1200));
        for(let char of word) { 
            speak(char); 
            // REDUCED PAUSE BETWEEN LETTERS (600ms)
            await new Promise(r => setTimeout(r, 600)); 
        }
        speak(word);
    }

    function renderMatch() {
        const correct = wordList[matchIdx];
        document.getElementById('match-img').src = correct.img;
        const container = document.getElementById('match-options'); container.innerHTML = '';
        let options = [...wordList].sort(() => 0.5 - Math.random()).slice(0, 3);
        if(!options.find(o => o.word === correct.word)) options[0] = correct;
        options.sort(() => 0.5 - Math.random()).forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'match-btn'; btn.innerText = opt.word;
            btn.onclick = () => {
                if(opt.word === correct.word) {
                    earnWordSuccess(opt.word);
                    setTimeout(() => { matchIdx = (matchIdx + 1) % wordList.length; renderMatch(); }, 1800);
                } else { speak("Try again"); }
            };
            container.appendChild(btn);
        });
    }

    function renderSpell() {
        const item = wordList[spellIdx];
        document.getElementById('spell-img').src = item.img;
        spellInput = "";
        document.getElementById('spell-slots').innerHTML = item.word.split('').map(() => `<div class="slot"></div>`).join('');
        const pool = document.getElementById('letter-pool'); pool.innerHTML = '';
        item.word.split('').sort(() => 0.5 - Math.random()).forEach(l => {
            const btn = document.createElement('button');
            btn.className = 'letter-btn'; btn.innerText = l;
            btn.onclick = () => {
                const slots = document.querySelectorAll('.slot');
                if(spellInput.length < item.word.length) {
                    slots[spellInput.length].innerText = l;
                    spellInput += l; speak(l);
                    if(spellInput === item.word) {
                        earnWordSuccess(item.word);
                        setTimeout(() => { spellIdx = (spellIdx + 1) % wordList.length; renderSpell(); }, 1800);
                    }
                }
            };
            pool.appendChild(btn);
        });
    }

    function renderLibrary() {
        const grid = document.getElementById('library-grid');
        grid.innerHTML = wordList.map(w => `
            <div class="lib-card" 
                 onmousedown="startPeek('${w.word}')" onmouseup="stopPeek()" 
                 ontouchstart="startPeek('${w.word}')" ontouchend="stopPeek()">
                ${w.word}
            </div>
        `).join('');
    }
    function startPeek(word) { pressTimer = setTimeout(() => showPopup(word), 500); }
    function stopPeek() { clearTimeout(pressTimer); }

    function showPopup(wordText) {
        const item = wordList.find(w => w.word === wordText);
        document.getElementById('pop-img').src = item.img;
        document.getElementById('pop-word').innerText = item.word;
        document.getElementById('lib-popup').style.display = 'flex';
        spellSequence(item.word);
    }
    function closePopup() { document.getElementById('lib-popup').style.display = 'none'; window.speechSynthesis.cancel(); }
    function replayPopSequence() { spellSequence(document.getElementById('pop-word').innerText); }

    function renderStickers() {
        const grid = document.getElementById('book-grid');
        grid.innerHTML = wordList.map(w => `
            <div class="sticker-slot ${w.count > 0 ? 'unlocked' : ''}">
                ${w.count > 0 ? `<div class="star-badge">üåü ${w.count}</div>` : ''}
                <img class="sticker-img" src="${w.img}" style="filter: ${w.count > 0 ? 'none' : 'grayscale(1) opacity(0.2)'}">
                <div style="margin-top:10px; font-weight:bold; color:#444; font-size:18px;">${w.count > 0 ? w.word : '???'}</div>
            </div>
        `).join('');
    }

    function handleBackspace() { if (spellInput.length > 0) { spellInput = spellInput.slice(0, -1); document.querySelectorAll('.slot')[spellInput.length].innerText = ""; }}
    function nextItem(m) { if(m==='learn') { learnIdx=(learnIdx+1)%wordList.length; renderLearn(); } }
    function prevItem(m) { 
        if(m==='learn') { learnIdx=(learnIdx-1+wordList.length)%wordList.length; renderLearn(); }
        if(m==='match') { matchIdx=(matchIdx-1+wordList.length)%wordList.length; renderMatch(); }
        if(m==='spell') { spellIdx=(spellIdx-1+wordList.length)%wordList.length; renderSpell(); }
    }
    function speak(t) { const u = new SpeechSynthesisUtterance(t); u.lang = 'en-US'; window.speechSynthesis.speak(u); }
    function toggleFullscreen() { if (!document.fullscreenElement) document.documentElement.requestFullscreen(); else document.exitFullscreen(); }

    setRandomQuote();
    showScreen('home');
</script>
</body>
</html>
